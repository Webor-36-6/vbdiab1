function SapeRtbCommon(){this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return this;};SapeRtbCommon.prototype.getStringHash=function(str){var strrev=str.split("").reverse().join(""),h1=this.crc32(str),h1s=h1.toString(),h2=this.crc32(strrev),h2s=h2.toString();return h1s+h2s;};SapeRtbCommon.prototype.utf8Encode=function(str){str=str.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<str.length;n++){var c=str.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}return utftext;};SapeRtbCommon.prototype.utf8Decode=function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}return string;};SapeRtbCommon.prototype.crc32=function(str){str=this.utf8Encode(str);var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 "+"0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 "+"1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 "+"136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 "+"3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B "+"35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 "+"26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F "+"2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D "+"76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 "+"7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 "+"6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 "+"65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 "+"4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB "+"4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 "+"5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F "+"5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD "+"EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 "+"E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 "+"F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 "+"FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 "+"D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B "+"D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 "+"CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F "+"C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D "+"9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 "+"95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 "+"86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 "+"88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 "+"A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB "+"AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 "+"BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF "+"B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var crc=0,x=0,y=0;crc=crc ^(-1);for(var i=0,iTop=str.length;i<iTop;i++){y=(crc ^ str.charCodeAt(i))&0xFF;x="0x"+table.substr(y*9,8);crc=(crc>>>8)^ x;}return(crc ^(-1))>>>0;};SapeRtbCommon.prototype.arrayUnique=function(arr){return arr.filter(function(e,p,a){return a.indexOf(e)===p;});};SapeRtbCommon.prototype.createIFrame=function(id,w,h,src){var f=document.createElement('iframe');f.setAttribute('scrolling','no');f.setAttribute('frameborder','0');f.setAttribute('marginwidth','0');f.setAttribute('marginheight','0');f.setAttribute('width',w);f.setAttribute('height',h);f.id=id;if(src!==false){f.src=(typeof src!=='undefined')?src:'about:blank';}return f;};SapeRtbCommon.prototype.createIFrameWithContent=function(p,html,width,height){var id='FRAME_'+p.id;p.appendChild(this.createIFrame(id,width,height));window.SapeRtbUCodeIFrameContent=function(n,id,html){var d;try{if(document.all&&!window.opera){d=window.frames[id].document;}else if(document.getElementById){d=document.getElementById(id).contentDocument;}}catch(e){;}if(n>0){if(typeof d==='undefined'){setTimeout(SapeRtbUCodeIFrameContent,100,--n,id,html);}else{d.open();d.write(html);d.close();}}};SapeRtbUCodeIFrameContent(10,id,html);};SapeRtbCommon.prototype.isInIframe=function(){try{return window.self!==window.top;}catch(e){return true;}};SapeRtbCommon.prototype.objectIsEqual=function(x,y){if(Object.is){return Object.is(x,y);}if(x===y){return x!==0||1/x===1/y;}return x!==x&&y!==y;};SapeRtbCommon.prototype.objectClone=function(source){if(Object.assign){return Object.assign({},source)}if(typeof source!=='object'){throw new TypeError('Cannot convert first argument to object');}var to=Object();var keysArray=Object.keys(Object(source));for(var nextIndex=0,len=keysArray.length;nextIndex<len;nextIndex++){var nextKey=keysArray[nextIndex];var desc=Object.getOwnPropertyDescriptor(source,nextKey);if(desc!==undefined&&desc.enumerable){to[nextKey]=source[nextKey];}}return to;};SapeRtbCommon.prototype.nodeRemove=function(node){if(typeof node.remove==='function'){node.remove();}else if(node.parentNode){node.parentNode.removeChild(node);}};SapeRtbCommon.prototype.nodeScriptClone=function(node){var script=document.createElement("script");script.text=node.innerHTML;for(var i=node.attributes.length-1;i>=0;i--){script.setAttribute(node.attributes[i].name,node.attributes[i].value);}return script;};SapeRtbCommon.prototype.evalNode=function(node){if(node.tagName==='SCRIPT'){node.parentNode.replaceChild(this.nodeScriptClone(node),node);}else{var i=0,children=node.childNodes;while(i<children.length){this.evalNode(children[i++]);}}return node;};SapeRtbCommon.prototype.addEventListenerCrossBrowser=function(target,type,handler){if(target.addEventListener){target.addEventListener(type,handler,false);}else if(target.attachEvent){target.attachEvent("on"+type,function(event){handler.call(target,event)});}else{throw 'Cannot add event listener: no Event API support in client'}};SapeRtbCommon.prototype.hasClass=function(e,c){return(" "+e.className+" ").indexOf(" "+c+" ")>-1;};SapeRtbCommon.prototype.previousTag=function(node){var n=node.previousSibling;return(n&&n.nodeType!=1)?this.previousTag(n):n;};SapeRtbCommon.prototype.nextTag=function(node){var n=node.nextSibling;return(n&&n.nodeType!=1)?this.nextTag(n):n;};SapeRtbCommon.prototype.firstChildTag=function(node){var n=node.firstChild;return(n&&n.nodeType!=1)?this.nextTag(n):n;};SapeRtbCommon.prototype.lastChildTag=function(node){var n=node.lastChild;return(n&&n.nodeType!=1)?this.previousTag(n):n;};SapeRtbCommon.prototype.encode64=function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=this.utf8Encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);}return output;};SapeRtbCommon.prototype.decode64=function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));enc2=this._keyStr.indexOf(input.charAt(i++));enc3=this._keyStr.indexOf(input.charAt(i++));enc4=this._keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}if(enc4!=64){output=output+String.fromCharCode(chr3);}}output=this.utf8Decode(output);return output;};SapeRtbCommon.prototype.sapeRTBisMobile=function(){return(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));};SapeRtbCommon.prototype.uniqid=function(){return(new Date().getTime()/1000).toString(16).split(".").join("").slice(0,9)+'_'+Math.round(Math.random()*100000000);};SapeRtbCommon.prototype.generateSessionId=function(){var uniqid=(Date.now()/1000).toString(16).split('.').join('');uniqid=uniqid+'00000000000000'.substring(0,14-uniqid.length);return uniqid.substring(0,8)+'-'+uniqid.substring(8,12)+'-'+uniqid.substring(12,14)+('xx-xxxx-xxxxxxxxxxxx'.replace(/[x]/g,function(){var r=Math.random()*36|0;return r.toString(36);}));};SapeRtbCommon.prototype.getPageOffsetY=function(){return window.pageYOffset!==undefined?window.pageYOffset:((document.compatMode||'')==='CSS1Compat')?document.documentElement.scrollTop:document.body.scrollTop;};SapeRtbCommon.prototype.insertAfter=function(referenceNode,newNode){if(referenceNode.nextSibling){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling);}else{referenceNode.parentNode.appendChild(newNode);}};SapeRtbCommon.prototype.getTimeZoneOffsetIso8601=function(){var o=(new Date()).getTimezoneOffset();return(o>0?"-":"+")+this.padInt(Math.floor(Math.abs(o)/60))+':'+this.padInt(Math.abs(o)%60);};SapeRtbCommon.prototype.encodeUriParam=function(value){if(null==value){return '';}value=''+value;return(encodeURIComponent instanceof Function)?encodeURIComponent(value):escape(value);};SapeRtbCommon.prototype.padInt=function(v){return(v<10?'0'+v:''+v);};SapeRtbCommon.prototype.onIFrameDocumentReady=function(id,onReady,onTimeout){var f=function(id,onReady,onTimeout,n){var d;try{if(document.all&&!window.opera){d=window.frames[id].document;}else if(document.getElementById){d=document.getElementById(id).contentDocument;}}catch(e){}if(n>0){if(typeof d==='undefined'||d===null||(d.readyState!='interactive'&&d.readyState!='complete')){n--;setTimeout(f,100,id,onReady,onTimeout,n);}else{onReady(d);}}else{onTimeout();}};f(id,onReady,onTimeout,50);};SapeRtbCommon.prototype.strEndsWith=function(str,suffix){return str&&str.indexOf(suffix,str.length-suffix.length)!==-1;};SapeRtbCommon.prototype.setConsole=function(){var methods=["assert","cd","clear","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","select","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"];var length=methods.length;var console=(window.console=window.console||{});var method;var noop=function(){};while(length--){method=methods[length];if(!console[method])console[method]=noop;}};SapeRtbCommon.prototype.clone=function(obj){var copy;if(null==obj||"object"!=typeof obj)return obj;if(obj instanceof Date){copy=new Date();copy.setTime(obj.getTime());return copy;}if(obj instanceof Array){copy=[];for(var i=0,len=obj.length;i<len;i++){copy[i]=this.clone(obj[i]);}return copy;}if(obj instanceof Object){copy={};for(var attr in obj){if(obj.hasOwnProperty(attr))copy[attr]=this.clone(obj[attr]);}return copy;}throw new Error("Unable to copy obj! Its type isn't supported.");};SapeRtbCommon.prototype.json_parse=function(sJSON){return eval('('+sJSON+')');};SapeRtbCommon.prototype.json_stringify=(function(){var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var isArray=Array.isArray||function(a){return toString.call(a)==='[object Array]';};var escMap={'"':'\\"','\\':'\\\\','\b':'\\b','\f':'\\f','\n':'\\n','\r':'\\r','\t':'\\t'};var escFunc=function(m){return escMap[m]||'\\u'+(m.charCodeAt(0)+0x10000).toString(16).substr(1);};var escRE=/[\\"\u0000-\u001F\u2028\u2029]/g;return function stringify(value){if(value==null){return 'null';}else if(typeof value==='number'){return isFinite(value)?value.toString():'null';}else if(typeof value==='boolean'){return value.toString();}else if(typeof value==='object'){if(typeof value.toJSON==='function'){return stringify(value.toJSON());}else if(isArray(value)){var res='[';for(var i=0;i<value.length;i++)res+=(i?', ':'')+stringify(value[i]);return res+']';}else if(toString.call(value)==='[object Object]'){var tmp=[];for(var k in value){if(hasOwnProperty.call(value,k))tmp.push(stringify(k)+': '+stringify(value[k]));}return '{'+tmp.join(', ')+'}';}}return '"'+value.toString().replace(escRE,escFunc)+'"';};})();SapeRtbCommon.prototype.get_keywords=function(){var keywords='';var metas=document.getElementsByTagName('meta');if(metas){for(var x=0,y=metas.length;x<y;x++){if(metas[x].name.toLowerCase()=="keywords"){keywords+=metas[x].content;}}}return keywords!=''?keywords:false;};SapeRtbCommon.prototype.get_href=function(){var href='';try{href=top.location.href;}catch(err){}if(href==''){var wnd=window;do{try{if(typeof wnd.document.referrer!=='undefined'){href=wnd.document.referrer.match(/([^\?]+)/)[1];}}catch(err){}if(wnd){wnd=wnd.parent;}}while(wnd&&wnd!=wnd.parent);}if(href==''){href=window.location.href;}return href;};function SapeRtbUCode(uid,sites,stubs){this.uid=uid;this.sites=sites;this.stubs=stubs;this.common=new SapeRtbCommon();this.sid=typeof window.srtb_sid!=='undefined'?window.srtb_sid:this.common.generateSessionId();this.placeInited=false;this.placeMarked=[];this.placeCount=[];this.placePopup=[];this.currentHref=[];this.useProxy=typeof window.srtb_proxy==='undefined'?false:window.srtb_proxy;this.useProxyAllowed=this.sapeRTBAllowedProxyUrl(["www.acint.net\/pxl\/","www.acint.net\/rtbw\/","cdn-rtb.sape.ru\/rtb-b\/u\/pxl\/","cdn-rtb.sape.ru\/js\/videojs\/"]);this.useProxyTracking=!!(this.useProxy&&parseInt(this.sapeRTBGetCookie('proxy_tracking')));return this;}SapeRtbUCode.prototype.findPlaces=function(){if(this.placeInited===false){this.placeInited=true;this.setPlacesData();}return document.querySelectorAll('.srtb-tag-'+this.uid+', .srtb-inpage-'+this.uid);};SapeRtbUCode.prototype.getCurrentHref=function(field){if(typeof field==='undefined'){field='href'}if(typeof this.currentHref[field]==='undefined'){try{this.currentHref[field]=top.location[field];}catch(err){}if(this.currentHref[field]===''){var wnd=window;do{try{if(typeof wnd.document.referrer!=='undefined'){if(field==='host'){this.currentHref[field]=wnd.document.referrer.match(/:\/\/(.[^/]+)/)[1];}else{this.currentHref[field]=wnd.document.referrer;}}}catch(err){}if(wnd){wnd=wnd.parent;}}while(wnd&&wnd!==wnd.parent);}if(this.currentHref[field]===''){this.currentHref[field]=window.location[field];}}return this.currentHref[field];};SapeRtbUCode.prototype.setPlacesData=function(){var places=this.findPlaces();for(var b=0;b<places.length;b++){var place=places[b];if(place.hasAttribute('data-ad-width')){var width=place.getAttribute('data-ad-width').match(/^([a-z]+)-(\d+)$/);if(width!==null){var height=place.getAttribute('data-ad-height').match(/^[a-z]+-(\d+)$/);if(height!==null){place.setAttribute('data-ad-height',height[1]);}place.setAttribute('data-ad-width',width[2]);place.setAttribute('data-ad-type',width[1]);}}}return places;};SapeRtbUCode.prototype.getPlaceProps=function(place){var w=parseInt(place.getAttribute('data-ad-width')||0),h=parseInt(place.getAttribute('data-ad-height')||0),t=place.getAttribute('data-ad-type')||'banner',p=parseInt(place.getAttribute('data-ad-popup')||0),c=0;if((' '+place.className+' ').indexOf(' srtb-inpage-'+this.uid+' ')>-1){t='inpage';c=1;}switch(t){case 'video':w=600;h=340;break;case 'inpage':w=640;h=480;break;}return{t:t,w:w,h:h,p:p,c:c};};SapeRtbUCode.prototype.getTypeByName=function(type,popup){var mobile=0,placeType=1;switch(type){case 'popup':popup=popup||1;break;case 'video':placeType=3;break;case 'float':placeType=4;break;case 'inpage':placeType=6;break;case 'mobile-fullscreen':placeType=7;mobile=1;break;case 'mobile-float':placeType=8;mobile=1;break;case 'mobile-video':placeType=9;mobile=1;break;}return{type:placeType,popup:parseInt(popup||0),mobile:mobile};};SapeRtbUCode.prototype.detectSite=function(host){while((host.match(/\./g)||[]).length>=1){var hostHash=this.common.getStringHash(host);for(var b=0;b<this.sites.length;b++){var site=this.sites[b];if(site.hash==hostHash){return b;}}host=host.substring(host.indexOf('.')+1,host.length);}return-1;};SapeRtbUCode.prototype.sapeRTBGetCookie=function(name){var matches=document.cookie.match(new RegExp("(?:^|; )"+('sape_rtb_'+name).replace(/([.$?*|{}()\[\]\\\/+^])/g,'\\$1')+"=([^;]*)"));if(matches){return  decodeURIComponent(matches[1]);}return undefined;};SapeRtbUCode.prototype.sapeRTBSetCookie=function(name,value,expires,path,domain){var props=['sape_rtb_'+name+'='+escape(value),'expires='+(new Date(new Date().getTime()+expires*1000)).toUTCString(),'path='+(typeof path==='undefined'?'/':path)];if(typeof domain!=='undefined'){props.push('domain='+domain);}document.cookie=props.join('; ');};SapeRtbUCode.prototype.sapeRTBAllowedProxyUrl=function(src){if(this.useProxy){return src;}return[];};SapeRtbUCode.prototype.sapeRTBGetProxyUrl=function(src){var test=false;if(this.useProxy!==false){this.useProxyAllowed.forEach(function(url){if(src.replace(/^(?:https?)?:?\/\//,'').substr(0,url.length)===url){test=true;}});}if(test){src=this.useProxy+'q='+window.btoa(src);}return src;};SapeRtbUCode.prototype.sapeRTBTrackingEvent=function(fn,ev,before){var src='https://www.acint.net/rtbw/'+fn+'?dp=0&cd='+this.common.encodeUriParam(JSON.stringify(ev))+'&sid='+this.sid+'&ref='+encodeURIComponent(this.getCurrentHref())+'&r=',possible='abcdefghijklmnopqrstuvwxyz0123456789';for(var i=0;i<12;i++){src+=possible.charAt(Math.floor(Math.random()*possible.length));}this.sapeRTBProxyTracking(src,before);};SapeRtbUCode.prototype.sapeRTBProxyTracking=function(src,before,useProxy){var self=this,pixel=document.createElement('img'),proxy=!!(this.useProxy&&((typeof useProxy!=='undefined'&&useProxy===true)||this.useProxyTracking===true));pixel.alt="";pixel.src=src;pixel.style.width='1px';pixel.style.height='1px';pixel.style.position='fixed';pixel.style.left='-100px';pixel.style.top='-100px';pixel.style.opacity='0';if(proxy){pixel.src=this.sapeRTBGetProxyUrl(pixel.src);}this.common.addEventListenerCrossBrowser(pixel,'error',function(){if(self.useProxy){if(self.useProxyTracking!==true){if(self.useProxyTracking===false){self.useProxyTracking=0;}self.useProxyTracking++;if(self.useProxyTracking>3){self.useProxyTracking=true;self.sapeRTBSetCookie('proxy_tracking',1,60);}}if(proxy===false){self.sapeRTBProxyTracking(src,before,true);}}self.common.nodeRemove(this);});this.common.addEventListenerCrossBrowser(pixel,'load',function(){self.common.nodeRemove(this);});if(typeof before!=='undefined'){before.parentNode.insertBefore(pixel,before);}else if(document.body!=null){document.body.appendChild(pixel);}else if(document.getElementsByTagName('body').length){document.getElementsByTagName('body')[0].appendChild(pixel);}};SapeRtbUCode.prototype.createUnknownPlacePixel=function(host,type,num,ad,before){var t=this.getTypeByName(type,ad.p||(ad.popup||0));this.sapeRTBTrackingEvent(3,{us:this.uid,st:this.site.id,pl:0,pt:t.type,mb:t.mobile,pp:t.popup,px:parseInt(ad.w||(ad.width||0)),py:parseInt(ad.h||(ad.height||0)),nm:num,dn:host},before);};SapeRtbUCode.prototype.createKnownPlacePixel=function(placeId,before){if(this.placeMarked.indexOf(placeId)===-1){this.sapeRTBTrackingEvent(3,{us:this.uid,st:this.site.id,pl:placeId},before);}};SapeRtbUCode.prototype.insertStub=function(width,height,appendTo){for(var b=0;b<this.stubs.length;b++){var stub=this.stubs[b];if(stub.w==width&&stub.h==height){if(stub.async){appendTo.innerHTML=this.common.decode64(stub.value);this.common.evalNode(appendTo);}else{appendTo.id='srtb-tag-'+(new Date().getTime())+'-'+parseInt(Math.random()*10000);this.common.createIFrameWithContent(appendTo,this.common.decode64(stub.value),stub.w,stub.h);}}}};SapeRtbUCode.prototype.showStubs=function(){var places=this.findPlaces();for(var b=0;b<places.length;b++){var place=places[b];if(!place.hasChildNodes()){this.insertStub(place.getAttribute('data-ad-width')||0,place.getAttribute('data-ad-height')||0,place);}}};SapeRtbUCode.prototype.showUnknownSitePixels=function(host,appendTo){var places=this.findPlaces();for(var b=0;b<places.length;b++){var place=places[b];if(place.hasAttribute('data-ad-done')===false){place.setAttribute('data-ad-done',1);var prop=this.getPlaceProps(place);if(prop.p&&(!prop.w||!prop.h)){continue;}var index=prop.t+'::'+prop.w+'x'+prop.h+'::'+prop.p;if(typeof this.placeCount[index]==='undefined'){this.placeCount[index]=0;}if(prop.p){if(this.placePopup.indexOf(prop.p)+1||this.placeCount[index]>0){continue;}this.placePopup.push(prop.p);}if(this.placeCount[index]>0&&prop.t!=='banner'){continue;}this.placeCount[index]++;this.createUnknownPlacePixel(host,prop.t,this.placeCount[index],prop,appendTo);}}if(window.srtb_places){var isMobile=this.common.sapeRTBisMobile();for(var key in window.srtb_places){if(Object.prototype.hasOwnProperty.call(window.srtb_places,key)){var ad=window.srtb_places[key];if(typeof ad.mobile!=='undefined'&&!!ad.mobile!==isMobile){continue;}if(typeof ad.popup!=='undefined'){if(this.placePopup.indexOf(ad.popup)+1){continue;}this.placePopup.push(ad.popup);}var placeType=(ad.mobile?'mobile-':'')+(ad.type||'banner');if(typeof this.placeCount[placeType]==='undefined'){this.placeCount[placeType]=1;this.createUnknownPlacePixel(host,placeType,1,ad);}}}}};SapeRtbUCode.prototype.getSiteFolder=function(siteId){var siteMod=(siteId%1000)+'',pad='000';return pad.substring(0,pad.length-siteMod.length)+siteMod;};SapeRtbUCode.prototype.getSiteScript=function(){return '//cdn-rtb.sape.ru/rtb-b/js/'+this.getSiteFolder(this.site.id)+'/2/'+this.site.id+'.js';};SapeRtbUCode.prototype.showKnownSitePlaces=function(host){var places=this.findPlaces();for(var b=0;b<places.length;b++){var place=places[b],sitePlaceFound=false;if(!place.hasAttribute('data-ad-done')){place.setAttribute('data-ad-done',1);var prop=this.getPlaceProps(place),type=this.getTypeByName(prop.t,prop.p),index=prop.t+'::'+prop.w+'x'+prop.h+'::'+type.popup;if(typeof this.placeCount[index]==='undefined'){this.placeCount[index]=0;}if(type.popup&&this.placePopup.indexOf(type.popup)+1){continue;}if(this.placeCount[index]>0&&prop.t!=='banner'){continue;}for(var i=0;i<this.site.places.length;i++){var sitePlace=this.site.places[i];if((sitePlace.t||1)!==type.type){continue;}if(sitePlace.p!==type.popup&&!(typeof sitePlace.p==='undefined'&&type.popup===0)){continue;}if(sitePlace.w!==prop.w||sitePlace.h!==prop.h){continue;}if(typeof sitePlace.a!=='undefined'){var alt=this.common.objectClone(sitePlace);alt.id=sitePlace.a.splice(0,1)[0];alt.a=sitePlace.a;if(alt.a.length===0){delete alt.a;}delete sitePlace.a;this.site.places.push(alt);}if((typeof sitePlace.done==='undefined'||sitePlace.done===false)&&document.getElementById('SRTB_'+sitePlace.id)===null){sitePlaceFound=true;sitePlace.done=true;if(type.popup){if(this.placePopup.indexOf(type.popup)+1||this.placeCount[index]>0){continue;}this.placePopup.push(prop.p);}if(prop.c){if(place.className.split(' ').indexOf('SRTB_INPAGE_'+sitePlace.id)===-1){place.className+=' SRTB_INPAGE_'+sitePlace.id;}}else{var div=document.createElement('div');div.id='SRTB_'+sitePlace.id;place.appendChild(div);}this.createKnownPlacePixel(sitePlace.id,place);this.placeCount[index]++;break;}}if(sitePlaceFound===false){this.placeCount[index]++;this.createUnknownPlacePixel(host,prop.t,this.placeCount[index],prop,place);}}}if(window.srtb_places){for(var key in window.srtb_places){if(Object.prototype.hasOwnProperty.call(window.srtb_places,key)){var ad=window.srtb_places[key];if(typeof ad.done==='undefined'||ad.done===false){if(typeof ad.mobile!=='undefined'&&!!ad.mobile!==this.common.sapeRTBisMobile()){continue;}var skip=false,placeFound=false,placeType=typeof ad.type==='undefined'&&typeof ad.popup!=='undefined'?'popup':((typeof ad.mobile!=='undefined'&&ad.mobile?'mobile-':'')+ad.type),props=this.getTypeByName(placeType,ad.popup);if(placeType!=='popup'){if(typeof this.placeCount[placeType]!=='undefined'){continue;}this.placeCount[placeType]=1;}for(var j=0;j<this.site.places.length;j++){var siteAbsPlace=this.site.places[j];if(props.popup){if(siteAbsPlace.w!==ad.width||siteAbsPlace.h!==ad.height){if(siteAbsPlace.p===ad.popup){skip=true;break;}continue;}if(this.placePopup.indexOf(ad.popup)+1){skip=true;break;}this.placePopup.push(ad.popup);placeFound=siteAbsPlace.id;break;}if(typeof siteAbsPlace.t==='undefined'){continue;}if(siteAbsPlace.t===props.type){placeFound=siteAbsPlace.id;break;}}if(skip===false){if(placeFound===false){this.createUnknownPlacePixel(host,placeType,1,ad);}else if(typeof this.site.stopped==='undefined'||this.site.stopped.indexOf(placeFound)===-1){this.createKnownPlacePixel(placeFound);}}ad.done=true;}}}}};SapeRtbUCode.prototype.showTopLevelScript=function(appendTo){var script=document.createElement('script');script.src=this.getSiteScript();script.async=true;if(typeof appendTo!=='undefined'){appendTo.appendChild(script);}else if(document.body!=null){document.body.appendChild(script);}else if(document.getElementsByTagName('body').length){document.getElementsByTagName('body')[0].appendChild(script);}};SapeRtbUCode.prototype.getCurrentHost=function(){var currentHost='';try{currentHost=top.location.host;}catch(err){}if(currentHost===''){var w=window;do{try{if(typeof w.document.referrer!=='undefined'){currentHost=w.document.referrer.match(/:\/\/(.[^/]+)/)[1];}}catch(err){}w=w.parent;}while(this.common.objectIsEqual(w,w.parent)===false);}if(currentHost===''){currentHost=window.location.host;}return currentHost;};SapeRtbUCode.prototype.bindOnReady=function(handler){var called=false,w=window;var ready=function(){if(called){return;}called=true;handler();};if(document.addEventListener){document.addEventListener("DOMContentLoaded",ready,false);}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){ready();}})}else if(w.addEventListener){w.addEventListener('load',ready,false);}else if(w.attachEvent){w.attachEvent('onload',ready);}else{var fn=w.onload;w.onload=function(){fn&&fn();ready();}}};SapeRtbUCode.prototype.runOnReady=function(){if(typeof window.srtb_places==='undefined'){var self=this;setTimeout(function(){self.run()});window.srtb_places=window.srtb_places||[];return;}if(typeof this.runned!=='undefined'){return;}this.runned=true;var currentHost=this.getCurrentHost();if(typeof this.site==='undefined'){this.site={id:0,ok:false};try{var sitesIndex=this.detectSite(currentHost);}catch(err){sitesIndex=0;}if(sitesIndex>=0){this.site=this.sites[sitesIndex];}}if(this.site.id>0&&typeof this.site.places!=='undefined'){if(typeof this.site.ok!=='undefined'&&this.site.ok===true){this.showKnownSitePlaces(currentHost);this.showTopLevelScript();}}else{this.showUnknownSitePixels(currentHost);}this.showStubs();};SapeRtbUCode.prototype.run=function(){var self=this;var run=function(){self.runOnReady();};if(document.readyState==='interactive'||document.readyState==='complete'){setTimeout(run,0);}else{this.bindOnReady(run);}};(function(w,d){var uid=1510037592;var sites=[{"id":85108,"hash":"31498558451608872828","ok":true,"places":[{"id":398999,"t":3,"w":600,"h":340},{"id":400264,"w":240,"h":400},{"id":590595,"t":6,"w":640,"h":480,"a":[509524]},{"id":592912,"t":9}]},{"id":85171,"hash":"859621765124927301","ok":true,"places":[{"id":399277,"w":970,"h":90},{"id":399278,"t":8}]},{"id":116888,"hash":"4242846075861622191","ok":false,"places":[{"id":590594,"t":9}]}];var stubs=[{"w":"240","h":"400","value":"PCEtLSBhZG1pdGFkLmJhbm5lcjogazRidWw1a3VvbzRmMTUxYjAwMGI3YTY2MGViZmFlIEFsaUV4cHJlc3MgUlUmQ0lTIC0tPg0KPGEgdGFyZ2V0PSJfYmxhbmsiIHJlbD0ibm9mb2xsb3ciIGhyZWY9Imh0dHBzOi8vYWxpdGVtcy5jb20vZy9rNGJ1bDVrdW9vNGYxNTFiMDAwYjdhNjYwZWJmYWUvP2k9NCI+PGltZyB3aWR0aD0iMjQwIiBoZWlnaHQ9IjQwMCIgYm9yZGVyPSIwIiBzcmM9Imh0dHBzOi8vYWQuYWRtaXRhZC5jb20vYi9rNGJ1bDVrdW9vNGYxNTFiMDAwYjdhNjYwZWJmYWUvIiBhbHQ9IkFsaUV4cHJlc3MgUlUmYW1wO0NJUyIvPjwvYT4NCjwhLS0gL2FkbWl0YWQuYmFubmVyIC0tPg==","async":true}];if(typeof w.sapeRtbUCodeInst_1510037592==='undefined'){w.sapeRtbUCodeInst_1510037592=new SapeRtbUCode(uid,sites,stubs);w.srtb_sid=w.sapeRtbUCodeInst_1510037592.sid;w.sapeRtbUCodeInst_1510037592.run();}})(window,document);